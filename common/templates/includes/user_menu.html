{% load static %}

{% if request.user.is_authenticated %}
    {% comment %} Start: User menu {% endcomment %}
    <div class="d-flex align-items-center ms-1 ms-lg-3" id="kt_header_user_menu_toggle">
        {% comment %} Start: Menu wrapper {% endcomment %}
        <div class="cursor-pointer symbol symbol-30px symbol-md-40px" data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
            {% if request.user.user.avatar == None %}
                <div class="symbol-label fs-3 bg-light-primary text-primary">{{ request.user.user.first_name.0|upper }}{{ request.user.user.last_name.0|upper }}</div>
            {% else %}
                <img src="{{ request.user.user.avatar_thumbnail_url }}" />
            {% endif %}
        </div>
        {% comment %} End: Menu wrapper {% endcomment %}

        {% comment %} Start: User account menu {% endcomment %}
        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px" data-kt-menu="true">
            
            {% comment %} Start: Menu item {% endcomment %}
            <div class="menu-item px-3">
                <div class="menu-content d-flex align-items-center px-3">
                    {% if request.user.user.avatar == None %}
                        <div class="symbol symbol-50px">
                            <div class="symbol-label fs-3 bg-light-primary text-primary">{{ request.user.user.first_name.0|upper }}{{ request.user.user.last_name.0|upper }}</div>
                        </div>
                    {% else %}
                        <div class="symbol symbol-50px">
                            <img src="{{ request.user.user.avatar_thumbnail_url }}" />
                        </div>
                    {% endif %}

                    {% comment %} Start: Username {% endcomment %}
                    <div class="d-flex flex-column ms-4">
                        <div class="fw-bolder d-flex align-items-center fs-5">{{ request.user.user.first_name|title }} {{ request.user.user.last_name|title }}</div>
                        <div class="fw-bold text-muted fs-7">{{ request.user.user.country.name }}</div>
                    </div>
                    {% comment %} End: Username {% endcomment %}
                </div>
            </div>
            {% comment %} End: Menu item {% endcomment %}

            {% comment %} Start: Separator {% endcomment %}
            <div class="separator my-2"></div>
            {% comment %} End: Separator {% endcomment %}

            {% comment %} Start: My leads menu item {% endcomment %}
            <div class="menu-item px-5">
                <a href="{% url 'leads:my_leads' %}" class="menu-link px-5">
                    <span class="menu-text">My Leads</span>

                    {% if request.user.user.num_leads > 0 %}
                        <span class="menu-badge">
                            <span class="badge badge-light-primary badge-circle fw-bolder fs-7">{{ request.user.user.num_leads }}</span>
                        </span>
                    {% endif %}
                </a>
            </div>
            {% comment %} End: My leads menu item {% endcomment %}

            {% comment %} Start: Settings menu item {% endcomment %}
            <div class="menu-item px-5">
                <a href="{% url 'users:settings' %}" class="menu-link px-5">Settings</a>
            </div>
            {% comment %} End: Settings menu item {% endcomment %}

            {% comment %} Start: Sign out menu item {% endcomment %}
            <div class="menu-item px-5">
                <a href="{% url 'logout' %}" class="menu-link px-5">Logout</a>
            </div>
            {% comment %} End: Sign out menu item {% endcomment %}
        </div>
        {% comment %} End: User account menu {% endcomment %}
    </div>
    {% comment %} End: User menu {% endcomment %}
    {% else %}
{% comment %} Start: Actions for the unauthenticated {% endcomment %}
<div class="d-flex align-items-center">
    <a href="{% url 'register' %}" class="btn btn-secondary me-2">Register</a>
    <a href="{% url 'login' %}" class="btn btn-primary">Login</a>
</div>
{% comment %} End: Actions for the unauthenticated {% endcomment %}
{% endif %}