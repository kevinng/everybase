{% extends 'extendables/b.html' %}

{% load static %}

{% comment %} TODO {% endcomment %}

{% comment %} Put in all the on-page SEO here {% endcomment %}
{% comment %} Include keywords {% endcomment %}
{% comment %}
Title is optimized for SEO purposes. String format:
- Buyer or seller
- If buying, source country. If selling, destination country.
- Goods/services keywords
We want to cache the title, so the code doesn't have to run each and everytime the page is loaded
{% endcomment %}

{% comment %}
CSS
https://codebeautify.org/css-beautify-minify

{% endcomment %}
{% block other_css %}
<link href="{% static 'common/css/photoswipe.min.css' %}" rel="stylesheet" />
<style>
</style>
{% endblock %}



{% block title %}{% endblock %}

{% block page_actions %}
{% comment %} WRONG {% endcomment %}
{% include 'relationships/includes/user_detail_actions.html' with detail_user=lead.author %}
{% endblock %}

{% block content %}
<div class="flex flex-col lg:flex-row justify-center mt-10 mb-10 gap-2">
    {% include 'relationships/includes/user_detail_side.html' with detail_user=lead.author %}


    {% comment %} SHALL I INCLUDE A FLOATING BUTTON THAT JUMPS TO THE USER SECTION IN MOBILE MODE? IN MOBILE WE DON'T REALLY WNAT TO SHOW USER ON TOP, BUT IT'S TOO FAR DOWN THE SCREEN {% endcomment %}
    <div class="w-full lg:w-1/2 lg:mt-0 mt-4">

        <div class="bg-white rounded px-8 py-8">
            <div class="flex items-start justify-between">
                <div class="text-xl font-bold">{% if lead.lead_type == 'buying' %}Buying{% elif lead.lead_type == 'selling' %}Selling{% endif %}, {% if lead.author_type == 'direct' %}Direct {% if lead.lead_type == 'buying' %}Buyer{% elif lead.lead_type == 'selling' %}Seller{% endif %}{% elif lead.author_type == 'broker' %}Middleman{% endif %}</div>
                <div class="text-sm">{{ lead.age_desc }}</div>
            </div>

            {% comment %} start: thumbnails {% endcomment %}
            <div class="flex items-start justify-start mt-2 gap-2">
                {% load thumbnail_url %}
                {% load image_url %}
                {% for file in lead.files.all %}
                    {% thumbnail_url file as thumbnail_url %}
                    {% image_url file as image_url %}
                    <a href="{{ image_url }}">
                        <img src="{{ thumbnail_url }}" class="border border-slate-200">
                    </a>
                {% endfor %}
            </div>
            {% comment %} end: thumbnails {% endcomment %}

                            
            <div>{% if lead.lead_type == 'buying' %}Buy from{% elif lead.lead_type == 'selling' %}Source is {% endif %} {% if lead.buy_country is None %}any country{% else %}{{ lead.buy_country.name }}{% endif %}</div>
            <div>{% if lead.lead_type == 'buying' %}Destination is{% elif lead.lead_type == 'selling' %}Sell to{% endif %} {% if lead.sell_country is None %}any country{% else %}{{ lead.sell_country.name }}{% endif %}</div>
            <div class="text-sm font-bold uppercase text-slate-400 mt-3">Details</div>
            <div>{% if summary == True %}{{ lead.details|slice:':200' }}{% if lead.details|length > 200 %}...{% endif %}{% else %}{{ lead.details }}{% endif %}</div>
            <div class="text-sm font-bold uppercase text-slate-400 mt-3">Average Agent Commission</div>
            <div>{{ lead.commissions }} %</div>
            {% if summary != True %}
            <div class="text-sm font-bold uppercase text-slate-400 mt-3">Average Deal Size</div>
            <div>USD {{ lead.avg_deal_size }}</div>
            <div class="text-sm font-bold uppercase text-slate-400 mt-3">Average Commission Per Deal</div>
            <div>USD {{ lead.commissions }}</div>
            {% if lead.other_comm_details is not None and lead.other_comm_details|cut:' ' != '' %}
                <div class="text-sm font-bold uppercase text-slate-400 mt-3">Other Commission Details</div>
                <div>{{ lead.other_comm_details }}</div>
            {% endif %}
            {% endif %}
            <div class="italic my-5">Actual commissions negotiated per deal.</div>
            
            <div class="flex justify-end">
                {% if summary == True %}
                    <a href="{% url 'leads:lead_detail' lead.id %}" class="px-6 py-2 text-slate-600 shadow-md bg-slate-100 hover:bg-slate-200 rounded-md">Details</a>
                {% endif %}
        
                {% if user.is_authenticated and user.user.id == lead.author.id %}
                    <a href="{% url 'leads:lead_edit' lead.id %}" class="px-6 py-2 ml-2 text-slate-600 shadow-md bg-slate-100 hover:bg-slate-200 rounded-md">Edit</a>
                {% endif %}
            </div>
        </div>
        




    </div>
</div>
{% endblock %}

{% comment %}
Javascript
https://codebeautify.org/minify-js
{% endcomment %}
{% block other_script %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
{% include 'relationships/includes/js/user_detail_side.js' %}
</script>
{% endblock %}